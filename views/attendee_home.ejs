<!-- attendee_home.ejs -->
<!-- Guest portal: Browse available cooking workshops -->
<!-- START -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browse Workshops | Flavor Academy</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/attendee.css">
    <link rel="stylesheet" href="/main.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

    <!-- navigation bar -->
    <nav class="navbar navbar-custom mb-4">
        <div class="container-fluid justify-content-end align-items-center" style="height: 100%;">
            <span class="navbar-brand mb-0">Flavor Academy</span>
        </div>
    </nav>

    <!-- back to home button -->
    <div class="mt-2 mb-4 home-btn-left">
        <a href="/" class="btn btn-outline-light btn-sm">Home</a>
    </div>
       
    <!-- success message popup -->
    <% if (typeof success !== 'undefined' && success && success.length > 0) { %>
        <div class="alert alert-success alert-dismissible fade show position-fixed top-0 start-50 translate-middle-x mt-4 z-3" style="width: 400px;" role="alert">
            <%= success[0] %>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    <% } %>

    <!-- page header -->
    <div class="container text-center mt-5 pt-5">
        <h1 class="mb-3">Attendee Home Page</h1>
        <h2><%= settings.site_name %></h2>
        <p class="text-light mb-4"><%= settings.site_description %></p>
    </div>
<!-- END -->

    <!-- category filter (extension feature) -->
    <% if (typeof categories !== 'undefined' && categories && categories.length > 0) { %>
    <div class="container mt-4">
        <div class="d-flex justify-content-center gap-2 flex-wrap">
            <a href="/attendee" class="btn btn-sm <%= !selectedCategory ? 'btn-accent' : 'btn-outline-light' %>">All</a>
            <% categories.forEach(cat => { %>
                <a href="/attendee?category=<%= cat.category_id %>"
                   class="btn btn-sm <%= (selectedCategory == cat.category_id) ? 'btn-accent' : 'btn-outline-light' %>">
                    <%= cat.name %>
                </a>
            <% }) %>
        </div>
    </div>
    <% } %>

    <!-- upcoming workshops section -->
    <div class="container mt-5">
        <h3 class="text-center text-info mb-3">Upcoming Workshops</h3>

        <% if (events.length === 0) { %>
            <p class="text-center text-muted">No workshops available right now. Check back soon!</p>
        <% } else { %>
            <div class="row justify-content-center g-4">
                <% events.forEach(event => { %>
                    <div class="col-12 col-md-6 col-lg-4">
                        <div class="card card-accent h-100">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title"><%= event.title %></h5>
                                <% if (event.category_name) { %>
                                    <span class="badge bg-secondary mb-2" style="width: fit-content;"><%= event.category_name %></span>
                                <% } %>
                                <p class="card-text"><strong>Date:</strong> <%= event.event_date %></p>
                                <p class="card-text text-muted flex-grow-1">
                                    <%= event.description ? event.description.substring(0, 100) + '...' : '' %>
                                </p>
                                <a href="/attendee/event/<%= event.event_id %>" class="btn btn-accent btn-sm mt-auto">View Details</a>
                            </div>
                        </div>
                    </div>
                <% }) %>
            </div>
        <% } %>
    </div>

    <!-- footer spacing -->
    <div class="mb-5"></div>

</body>
</html>
